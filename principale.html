<!--
created on the 29/05/2018 by Guiala Jean Roger
-->
<!-- Application de visualisation des AOC viticoles -->
<!--Work starting : 29/05/2018
View conception and test
-->

<!DOCTYPE html>


<html>

    <head>

        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <title>SeekINAOv.1</title>

        <link href="assets/css/bootstrap.min.css" rel="stylesheet">
        <link href="assets/font-awesome/css/font-awesome.css" rel="stylesheet">
        <link href="assets/css/animate.css" rel="stylesheet">
        <link href="assets/css/style.css" rel="stylesheet">
        <link href="assets/css/plugins/select2/select2.min.css" rel="stylesheet">
        <!--OpenLayers version 4.6.5 CSS-->
        <link href="assets/css/ol.css" rel="stylesheet">

        <!--Geoportail openLayerExtension CSS-->
        <link href="assets/css/GpPluginOpenLayers.css" rel="stylesheet">
        <style>
            .map{

                height: 882px;
            }
        </style>


        <!--Proj4js pour la projection (mais il est inclu dans l'extension du Géoportail
        <script src="https://cdnjs.cloudflare.com/ajax/libs/proj4js/2.4.4/proj4.js" type="text/javascript"></script>-->

        <!--OpenLayers version 4.6.5 JS-->
        <script src="assets/js/ol.js" type="text/javascript"></script>

        <!-- Geoportail OpenLayerExtension JS -->
        <script data-url="assets/autoconf.json"  src='assets/js/GpPluginOpenLayers.js' type="text/javascript"></script>

    </head>

    <body class="top-navigation">

        <div id="wrapper">
            <div id="page-wrapper" class="gray-bg">
                <div class="row border-bottom white-bg">
                    <nav class="navbar navbar-static-top" role="navigation">
                        <div class="navbar-header">
                            <button aria-controls="navbar" aria-expanded="false" data-target="#navbar" data-toggle="collapse" class="navbar-toggle collapsed" type="button">
                                <i class="fa fa-reorder"></i>
                            </button>
                            <a href="http:/www.inao.gouv.fr" target="_blank" class="navbar-brand"><img src="assets/img/Configuration_inao_logo.png" class="logoInao"></a>
                        </div>
                        <div class="navbar-collapse collapse" id="navbar">
                            <ul class="nav navbar-nav">
                                <li class="active recherche">

                                    <div class=" searchGroup1">
                                        <div class="input-group inputSearch1">
                                            <input type="text" placeholder="chercher une Appelation, une commune, une parcelle... " class="input form-control">
                                            <span class="input-group-btn">
                                                <button type="button" class="btn btn btn-primary" data-toggle="modal" data-target="#myModal4"> <i class="fa fa-plus fa-1x"></i> </button>
                                            </span>
                                        </div>

                                    </div>

                                </li>

                            </ul>
                            <ul class="nav navbar-top-links navbar-right">
                                <li>
                                    <a href="#" class="right-sidebar-toggle">
                                        <i class=" fa fa-tasks fa-3x"></i> <!--modif ici-->
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </nav>
                </div>
                <div  class=" carte"><!--wrapper wrapper-content-->
                    <div class="container-fluid ">
                        <div class="row ">
                            <div class="col-lg-12">
                                <div id="map" class="map"></div>
                                <script>
                                    function go() {

                                        var scaleLineControl = new ol.control.ScaleLine();
                                        scaleLineControl.setUnits("metric");
                                        var projection = new ol.proj.Projection({
                                            code: 'EPSG:2154',
                                            extent: [-357823.2365, 6037008.6939, 1313632.3628, 7230727.3772],
                                            units: 'm'
                                        }); // definition du EPSG 2154
                                        ol.proj.addProjection(projection); //inclusion du EPSG dans openlayer
                                        var proj2154 = ol.proj.get('EPSG:2154'); //recupération de la projection
                                        var projectionExtent = proj2154.getExtent(); //recupération de l'étendu de la projection 

                                        var variable = 22;
                                        var resolutions = new Array(variable);
                                        /* resolutions[0] = 104579.2245498940;
                                         resolutions[1] = 52277.5323537905;
                                         resolutions[2] = 26135.4870785954;
                                         resolutions[3] = 13066.8913818000;
                                         resolutions[4] = 6533.2286041135;
                                         resolutions[5] = 3266.5595244627;
                                         resolutions[6] = 1633.2660045974;
                                         resolutions[7] = 816.6295549860;*/

                                        var matrixIds = new Array(variable);

                                        //alert(proj2154.getExtent());

                                        //var maxResolution = ol.extent.getWidth(projectionExtent) / 256; //recupérationd des résolutions
                                        var maxResolution = 104579.224549894;
                                        //alert(maxResolution);

                                        for (var i = 0; i < variable; ++i) {
                                            matrixIds[i] = 'EPSG:2154:' + i;
                                            resolutions[i] = (maxResolution) / Math.pow(2, i);
                                            //alert(resolutions[i]);

                                        }

                                        var tileGrid = new ol.tilegrid.WMTS({
                                            origin: ol.extent.getTopLeft(projectionExtent),
                                            // origin:[-378300, 7235610],
                                            resolutions: resolutions,
                                            matrixIds: matrixIds
                                        });

                                        var languedoc_source = new ol.source.WMTS({
                                            url: 'http://127.0.0.1:8080/geoserver/gwc/service/wmts?REQUEST=getcapabilities',
                                            layer: 'test:languedoc',
                                            matrixSet: 'EPSG:2154',
                                            format: 'image/png',
                                            projection: proj2154,
                                            tileGrid: tileGrid,
                                            style: 'polygon',
                                            wrapX: true


                                        });
                                        var lang = new ol.layer.Tile({
                                            opacity: 0.7,
                                            source: languedoc_source

                                        });
                                        var coucheIGN = new ol.layer.Tile({
                                            source: new ol.source.GeoportalWMTS({
                                                projection: "EPSG:2154",
                                                // layer: "CADASTRALPARCELS.PARCELS",
                                                layer: "GEOGRAPHICALGRIDSYSTEMS.MAPS.SCAN-EXPRESS.ROUTIER.L93",
                                                style: "normal",

                                            }),

                                            opacity: 0.8
                                        });
                                        var map = new ol.Map({
                                            controls: ol.control.defaults({
                                                attributionOptions: {
                                                    collapsible: false
                                                }
                                            }).extend([
                                                scaleLineControl
                                            ]),
                                            target: 'map',
                                            layers: [coucheIGN, lang],
                                            view: new ol.View({
                                                projection: proj2154,
                                                center: [690294.769471, 6206792.476654],
                                                //center: [320729.77, 5305952.76], //coordonnées en 3857   
                                                zoom: 9
                                            })
                                        });
                                        // map.addLayer(lang); //ajout du layer languedoc à la carte
                                    }

                                    Gp.Services.getConfig({
                                        apiKey: "1g3c8evz5w5tcus9a7oawl77",
                                        onSuccess: go
                                    });

                                </script>
                            </div>

                        </div>

                    </div>

                </div>
                <div class="footer">
                    <div class="pull-right">
                        Application de visualisation des  <strong>AOC</strong> viticoles.
                    </div>
                    <div>
                        <strong>Copyright</strong> INAO &copy; 2018
                    </div>
                </div>

            </div>
            <!--debut zone param-->


            <div id="right-sidebar" class="resize-drag animated">
                <div class="sidebar-container">

                    <ul class="nav nav-tabs navs-3">

                        <li class="active"><a data-toggle="tab" href="#tab-1">
                                Notes
                            </a></li>
                        <li><a data-toggle="tab" href="#tab-2">
                                Projects
                            </a></li>
                        <li class=""><a data-toggle="tab" href="#tab-3">
                                <i class="fa fa-gear"></i>
                            </a></li>
                    </ul>

                    <div class="tab-content">
                        <div id="tab-1" class="tab-pane active">

                            <div class="sidebar-title">
                                <h3> <i class="fa fa-comments-o"></i> FIRST</h3>
                                <small><i class="fa fa-tim"></i> premier onglet .....</small>
                            </div>

                            <div>

                                <div class="sidebar-message">
                                    <div class="col-md-12">
                                        <p>
                                            Select2 also supports multi-value select boxes. The select below is declared with the multiple attribute.
                                        </p>
                                        <select class="select2_demo_2 form-control" multiple="multiple">
                                            <option value="Languedoc">Languedoc</option>
                                            <option value="Bugey">Bugey</option>
                                            <option value="Ajaccio">Ajacio</option>
                                             <option value="Barsac">Barsac</option>
                                               <option value="Bonnes-Mares">Bonnes-Mares</option>
                                            
                                        </select>

                                    </div>
                                </div>

                            </div>

                        </div>

                        <div id="tab-2" class="tab-pane">

                            <div class="sidebar-title">
                                <h3> <i class="fa fa-cube"></i> SECOND </h3>
                                <small><i class="fa fa-tim"></i> second onglet lorem ipsum...</small>
                            </div>

                            <ul class="sidebar-list">


                            </ul>

                        </div>

                        <div id="tab-3" class="tab-pane">

                            <div class="sidebar-title">
                                <h3><i class="fa fa-gears"></i> Paramètres</h3>
                                <small><i class="fa fa-tim"></i> onglet 3 paramètres lorem ipsum</small>
                            </div>

                            <div class="setings-item">
                                <span>
                                    param 1
                                </span>
                                <div class="switch">
                                    <div class="onoffswitch">
                                        <input type="checkbox" name="collapsemenu" class="onoffswitch-checkbox" id="example">
                                        <label class="onoffswitch-label" for="example">
                                            <span class="onoffswitch-inner"></span>
                                            <span class="onoffswitch-switch"></span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="setings-item">
                                <span>
                                    param 2
                                </span>
                                <div class="switch">
                                    <div class="onoffswitch">
                                        <input type="checkbox" name="collapsemenu" checked class="onoffswitch-checkbox" id="example2">
                                        <label class="onoffswitch-label" for="example2">
                                            <span class="onoffswitch-inner"></span>
                                            <span class="onoffswitch-switch"></span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <div class="setings-item">
                                <span>
                                    param 3
                                </span>
                                <div class="switch">
                                    <div class="onoffswitch">
                                        <input type="checkbox" name="collapsemenu" class="onoffswitch-checkbox" id="example3">
                                        <label class="onoffswitch-label" for="example3">
                                            <span class="onoffswitch-inner"></span>
                                            <span class="onoffswitch-switch"></span>
                                        </label>
                                    </div>
                                </div>
                            </div>

                            <div class="sidebar-content">
                                <h4>Paramètres</h4>
                                <div class="small">
                                    Lorem ipsum dolor dolor test 
                                </div>
                            </div>

                        </div>
                    </div>

                </div>



            </div>

        </div>



        <!-- Mainly scripts -->
        <script src="assets/js/jquery-3.1.1.min.js"></script>
        <script src="assets/js/bootstrap.min.js"></script>


        <script src="assets/js/principale.js"></script>

        <script src="assets/js/plugins/metisMenu/jquery.metisMenu.js"></script>
        <script src="assets/js/plugins/slimscroll/jquery.slimscroll.min.js"></script>

        <!-- Custom and plugin javascript -->
        <script src="assets/js/inspinia.js"></script>
        <script src="assets/js/plugins/pace/pace.min.js"></script>
        <!-- Select2 -->
        <script src="assets/js/plugins/select2/select2.full.min.js"></script>

        <script>
                                    $(document).ready(function () {
                                        $(".select2_demo_2").select2();
                                    });
        </script>


        <!--debut form recherche avancée-->
        <div class="modal inmodal" id="myModal4" tabindex="-1" role="dialog"  aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content animated fadeIn">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                        <i class="fa fa-search modal-icon"></i>
                        <h4 class="modal-title">Recherche avancée</h4>
                        <small>Lorem Ipsum is simply dummy text of the printing and typesetting industry.</small>
                    </div>
                    <div class="modal-body">
                        <form class="form-horizontal">
                            <div class="form-group"><label class="col-lg-2 control-label"><i class="fa fa-filter fa-2x"></i></label>
                                <div class="col-lg-10">
                                    <select class="form-control">
                                        <option>AOC</option>
                                        <option>commune</option>
                                        <option>périmètre précis</option>
                                        <option>Parcelle</option>
                                    </select>

                                </div>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-white" data-dismiss="modal">Close</button>
                        <button type="button" class="btn btn-primary">Save changes</button>
                    </div>
                </div>
            </div>
        </div>



    </body>



</html>
